# Wind Turbine Power Prediction using LSTM

본 저장소는 LSTM(Long Short-Term Memory) 딥러닝 모델을 활용하여 풍력발전기의 전력 생산량을 예측하는 프로젝트입니다. 기상 데이터를 기반으로 시계열 예측을 수행하여 풍력 발전량을 정확하게 예측하는 것이 목표입니다.

## 프로젝트 개요

풍력발전은 기상 조건에 크게 의존하는 재생에너지입니다. 풍속, 온도, 습도 등의 기상 변수들이 복합적으로 작용하여 발전량이 결정되므로, 이를 정확히 예측하는 것은 전력 공급 계획과 에너지 관리에 매우 중요합니다.

## 데이터셋

- **데이터 기간**: 2017년 1월 - 2022년 (약 43,800개 시간별 데이터)
- **주요 변수**:
  - `temperature_2m`: 지상 2m 온도 (°C)
  - `relativehumidity_2m`: 상대습도 (%)
  - `dewpoint_2m`: 이슬점 온도 (°C)
  - `windspeed_10m`: 지상 10m 풍속 (m/s)
  - `windspeed_100m`: 100m 높이 풍속 (m/s)
  - `winddirection_10m`: 지상 10m 풍향 (도)
  - `winddirection_100m`: 100m 높이 풍향 (도)
  - `windgusts_10m`: 돌풍 (m/s)
  - `Power`: 발전량 (MW) - **예측 목표 변수**

## 파일별 상세 설명

### 01_LSTM_normal.ipynb
**기본 LSTM 모델 구현 및 학습**

이 노트북은 가장 기본적인 LSTM 모델을 구현합니다.

**주요 과정**:
1. **데이터 전처리**: Location1.csv 파일 로드 및 정규화
2. **특성 선택**: 풍속, 돌풍, 이슬점 온도 등 4개 핵심 변수 선택
3. **시계열 데이터 변환**: 24시간 이전 데이터를 기반으로 현재 발전량 예측
4. **모델 구조**: 
   - 양방향 LSTM (Bidirectional LSTM) 적용
   - 4개 LSTM 레이어, 은닉 유닛 256개
   - 드롭아웃 35% 적용
5. **학습 설정**:
   - 데이터 분할: 훈련(80%), 검증(10%), 테스트(10%)
   - 조기 종료(Early Stopping) 적용
   - Adam 옵티마이저, MSE 손실함수 사용

**핵심 개념**:
- **LSTM**: 기존 RNN의 장기 의존성 문제를 해결한 순환 신경망
- **양방향 LSTM**: 과거와 미래 정보를 모두 활용하여 예측 성능 향상
- **시계열 예측**: 과거 패턴을 학습하여 미래 값을 예측하는 기법

**결과**: RMSE 0.1600 달성, 훈련 과정에서 조기 종료를 통한 과적합 방지

### 02_LSTM_v1.ipynb
**개선된 LSTM 모델 (버전 1)**

첫 번째 모델의 성능을 개선하기 위한 고도화된 LSTM 구현입니다.

**주요 개선사항**:
- 모델 아키텍처 최적화
- 하이퍼파라미터 튜닝
- 배치 정규화 또는 추가적인 정규화 기법 적용
- 학습률 스케줄링 구현

**비전공자를 위한 설명**:
머신러닝에서는 첫 번째 모델의 결과를 분석하여 부족한 부분을 개선합니다. 마치 요리 레시피를 개선하듯이, 모델의 '재료'(데이터)와 '조리법'(알고리즘)을 조정하여 더 정확한 예측을 만들어냅니다.

### 03_Transformer.ipynb
**Transformer 모델 적용**

최신 딥러닝 기법인 Transformer를 풍력발전 예측에 적용한 실험입니다.

**Transformer의 특징**:
- **어텐션 메커니즘**: 입력 데이터의 중요한 부분에 집중하여 학습
- **병렬 처리**: LSTM보다 빠른 학습 속도
- **장거리 의존성**: 더 긴 시간 범위의 패턴 학습 가능

**비전공자를 위한 설명**:
Transformer는 ChatGPT와 같은 AI의 핵심 기술입니다. 시계열 데이터에서도 '어떤 시점의 데이터가 가장 중요한지'를 스스로 판단하여, 더 정확한 예측을 만들어냅니다.

### 04_Feature_Eng.ipynb
**특성 공학 (Feature Engineering)**

원본 데이터에서 새로운 의미있는 변수들을 생성하여 모델 성능을 향상시킵니다.

**주요 기법**:
- **파생 변수 생성**: 풍속과 풍향을 조합한 새로운 변수
- **시간적 특성**: 시간, 요일, 계절성 변수 추가
- **통계적 특성**: 이동평균, 표준편차 등 계산
- **다항식 특성**: 변수 간 상호작용 효과 포착

**비전공자를 위한 설명**:
요리할 때 기본 재료로 소스를 만들거나 양념을 조합하듯이, 원본 데이터를 가공하여 AI가 더 잘 이해할 수 있는 형태로 변환하는 과정입니다. 예를 들어, 풍속과 풍향을 조합하면 실제 발전에 영향을 주는 '유효 풍속'을 계산할 수 있습니다.

### 05_Light_LSTM.ipynb
**경량화 LSTM 모델**

실제 현장 적용을 위한 가벼운 모델을 개발합니다.

**경량화 전략**:
- **모델 압축**: 레이어 수 및 파라미터 감소
- **지식 증류**: 복잡한 모델의 지식을 간단한 모델로 전달
- **양자화**: 모델 크기 압축

**실용적 관점**:
- 빠른 추론 속도
- 적은 메모리 사용량
- 실시간 예측 가능

**비전공자를 위한 설명**:
스마트폰 앱이 빨리 작동하도록 최적화하는 것처럼, AI 모델도 실제 현장에서 빠르게 작동할 수 있도록 '다이어트'시키는 과정입니다. 성능은 유지하되 크기와 계산량을 줄여 실용성을 높입니다.

### 06_Lag_Feature.ipynb
**시차 변수 (Lag Features) 활용**

과거 시점의 데이터를 체계적으로 활용하여 예측 성능을 개선합니다.

**시차 변수의 중요성**:
- **시간 지연 효과**: 과거 기상 조건이 현재 발전량에 미치는 영향
- **계절성 패턴**: 일별, 주별, 월별 주기적 패턴 포착
- **자기상관성**: 발전량 자체의 시간적 연속성 활용

**구현 방법**:
- 1시간, 3시간, 6시간, 24시간 전 데이터 활용
- 이동 평균 및 이동 표준편차 계산
- 계절성 분해를 통한 트렌드 분석

**비전공자를 위한 설명**:
날씨 예보에서 "어제 비가 왔으니 오늘도 흐릴 가능성이 높다"고 판단하듯이, 과거의 패턴을 체계적으로 분석하여 미래를 예측하는 기법입니다. 풍력발전도 바람의 연속성과 계절성을 고려하면 더 정확한 예측이 가능합니다.

## 핵심 기술 개념

### LSTM (Long Short-Term Memory)
시계열 데이터의 장기 의존성을 학습할 수 있는 순환 신경망입니다. 기존 RNN의 기울기 소실 문제를 해결하여 긴 시간 범위의 패턴을 효과적으로 학습합니다.

### 시계열 예측
과거의 시간 순서가 있는 데이터를 바탕으로 미래 값을 예측하는 기법입니다. 풍력발전 예측에서는 기상 데이터의 시간적 패턴을 학습하여 발전량을 예측합니다.

### 특성 공학
원본 데이터에서 모델 성능 향상에 도움이 되는 새로운 변수를 생성하는 과정입니다. 도메인 지식과 통계적 기법을 결합하여 데이터의 예측력을 높입니다.

## 모델 성능 평가

- **평가 지표**: RMSE (Root Mean Square Error)
- **교차 검증**: 시계열 데이터 특성을 고려한 시간 순서 보존
- **실제 운영 환경**: 실시간 예측 성능 및 안정성 검증

## 실무 적용 방안

1. **에너지 관리 시스템**: 발전량 예측을 통한 효율적인 전력 공급 계획
2. **유지보수 계획**: 기상 조건 예측을 통한 터빈 운영 최적화
3. **경제성 분석**: 정확한 발전량 예측을 통한 수익성 개선
4. **그리드 안정성**: 재생에너지 간헐성 해결을 위한 예측 시스템

## 기술적 특징

- **PyTorch 기반 구현**: 유연하고 확장 가능한 딥러닝 프레임워크 활용
- **모듈화된 코드**: 재사용 가능하고 유지보수가 용이한 구조
- **조기 종료**: 과적합 방지를 위한 자동 학습 중단 기능
- **GPU 가속**: CUDA를 활용한 빠른 학습 및 추론

## 향후 개선 방향

1. **앙상블 모델**: 여러 모델의 결과를 결합하여 예측 성능 향상
2. **외부 데이터 활용**: 위성 데이터, 수치예보 모델 결과 통합
3. **실시간 학습**: 새로운 데이터로 모델을 지속적으로 업데이트
4. **불확실성 정량화**: 예측 결과의 신뢰도 구간 제공

## 결론

본 프로젝트는 LSTM을 기반으로 한 풍력발전 예측 시스템의 체계적인 개발 과정을 보여줍니다. 기본 모델부터 시작하여 다양한 개선 기법을 적용함으로써, 실제 현장에서 활용 가능한 수준의 예측 성능을 달성했습니다. 특히 특성 공학과 시차 변수 활용을 통해 도메인 지식을 모델에 효과적으로 반영했으며, 경량화 모델을 통해 실용성도 확보했습니다.
